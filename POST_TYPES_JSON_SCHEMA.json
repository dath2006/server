{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Post Creation Schema",
  "description": "JSON Schema for all post types in the Chyrp Lite Reimagine system",
  "type": "object",
  "properties": {
    "title": {
      "type": "string",
      "description": "Post title",
      "minLength": 1,
      "maxLength": 500
    },
    "type": {
      "type": "string",
      "enum": ["text", "quote", "link", "photo", "file", "audio", "video"],
      "description": "Post type determines which content fields are required"
    },
    "content": {
      "type": "object",
      "description": "Post content varies by type",
      "oneOf": [
        {
          "title": "Text Post Content",
          "properties": {
            "body": {
              "type": "string",
              "description": "Markdown content for text post",
              "minLength": 1
            }
          },
          "required": ["body"],
          "additionalProperties": false
        },
        {
          "title": "Quote Post Content",
          "properties": {
            "quote": {
              "type": "string",
              "description": "The quote text (Markdown supported)",
              "minLength": 1
            },
            "source": {
              "type": "string",
              "description": "Commentary/thoughts about the quote (Markdown supported)",
              "default": ""
            }
          },
          "required": ["quote"],
          "additionalProperties": false
        },
        {
          "title": "Link Post Content",
          "properties": {
            "url": {
              "type": "string",
              "format": "uri",
              "description": "URL to share"
            },
            "description": {
              "type": "string",
              "description": "Commentary about the link (Markdown supported)",
              "default": ""
            }
          },
          "required": ["url"],
          "additionalProperties": false
        },
        {
          "title": "Photo Post Content",
          "properties": {
            "imageFiles": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "binary",
                "description": "Image file (multipart/form-data)"
              },
              "minItems": 1,
              "description": "Array of image files"
            },
            "altText": {
              "type": "string",
              "description": "Alternative text for accessibility",
              "default": ""
            },
            "sourceUrl": {
              "type": "string",
              "format": "uri",
              "description": "External source URL if image is from another site",
              "default": ""
            },
            "caption": {
              "type": "string",
              "description": "Photo caption (Markdown supported)",
              "default": ""
            }
          },
          "required": ["imageFiles"],
          "additionalProperties": false
        },
        {
          "title": "File Post Content",
          "properties": {
            "files": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "binary",
                "description": "File attachment (multipart/form-data)"
              },
              "minItems": 1,
              "description": "Array of files to share"
            },
            "description": {
              "type": "string",
              "description": "Description of files, usage instructions (Markdown supported)",
              "default": ""
            }
          },
          "required": ["files"],
          "additionalProperties": false
        },
        {
          "title": "Audio Post Content",
          "properties": {
            "audioFile": {
              "type": "string",
              "format": "binary",
              "description": "Audio file (multipart/form-data)"
            },
            "captionFile": {
              "type": "string",
              "format": "binary",
              "description": "Optional transcript/caption file (.vtt, .srt, .ass, .txt)"
            },
            "description": {
              "type": "string",
              "description": "Audio description, show notes (Markdown supported)",
              "default": ""
            }
          },
          "required": ["audioFile"],
          "additionalProperties": false
        },
        {
          "title": "Video Post Content",
          "properties": {
            "sourceType": {
              "type": "string",
              "enum": ["upload", "url"],
              "description": "Whether video is uploaded or from URL",
              "default": "upload"
            },
            "videoFile": {
              "type": "string",
              "format": "binary",
              "description": "Video file (required if sourceType is 'upload')"
            },
            "videoUrl": {
              "type": "string",
              "format": "uri",
              "description": "Video URL (required if sourceType is 'url')"
            },
            "posterImage": {
              "type": "string",
              "format": "binary",
              "description": "Optional thumbnail/poster image file"
            },
            "captionFiles": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "binary",
                "description": "Subtitle file (.vtt, .srt, .ass)"
              },
              "description": "Optional subtitle files"
            },
            "description": {
              "type": "string",
              "description": "Video description, chapters, additional info (Markdown supported)",
              "default": ""
            }
          },
          "required": ["sourceType"],
          "oneOf": [
            {
              "properties": {
                "sourceType": { "const": "upload" },
                "videoFile": { "type": "string", "format": "binary" }
              },
              "required": ["videoFile"]
            },
            {
              "properties": {
                "sourceType": { "const": "url" },
                "videoUrl": { "type": "string", "format": "uri" }
              },
              "required": ["videoUrl"]
            }
          ],
          "additionalProperties": false
        }
      ]
    },
    "status": {
      "type": "string",
      "enum": ["published", "draft", "private", "scheduled"],
      "description": "Post publication status",
      "default": "draft"
    },
    "visibility": {
      "type": "string",
      "enum": ["public", "private", "draft", "scheduled", "groups"],
      "description": "Post visibility level",
      "default": "public"
    },
    "visibilityGroups": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Group IDs that can see the post (only relevant if visibility is 'groups')",
      "default": []
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 100
      },
      "description": "Post tags",
      "default": []
    },
    "category": {
      "type": "string",
      "description": "Post category ID or name",
      "default": ""
    },
    "scheduledDate": {
      "type": "string",
      "format": "date-time",
      "description": "Scheduled publication date (ISO 8601 format, required if status is 'scheduled')"
    },
    "isPinned": {
      "type": "boolean",
      "description": "Whether the post is pinned",
      "default": false
    },
    "allowComments": {
      "type": "boolean",
      "description": "Whether comments are allowed on this post",
      "default": true
    },
    "slug": {
      "type": "string",
      "description": "Custom URL slug (optional, will be auto-generated if not provided)",
      "pattern": "^[a-z0-9-]+$"
    }
  },
  "required": ["title", "type", "content"],
  "additionalProperties": false,
  "examples": [
    {
      "title": "My First Text Post",
      "type": "text",
      "content": {
        "body": "This is a **markdown** text post with some content."
      },
      "status": "published",
      "visibility": "public",
      "tags": ["introduction", "first-post"],
      "category": "general",
      "isPinned": false,
      "allowComments": true
    },
    {
      "title": "Inspiring Quote",
      "type": "quote",
      "content": {
        "quote": "The only way to do great work is to love what you do.",
        "source": "This quote by Steve Jobs really resonates with me because..."
      },
      "status": "published",
      "visibility": "public",
      "tags": ["inspiration", "quotes"]
    },
    {
      "title": "Check out this awesome article",
      "type": "link",
      "content": {
        "url": "https://example.com/awesome-article",
        "description": "This article explains modern web development practices in detail."
      },
      "status": "published",
      "visibility": "public",
      "tags": ["web-development", "resources"]
    },
    {
      "title": "Photo Gallery from Vacation",
      "type": "photo",
      "content": {
        "imageFiles": ["file1.jpg", "file2.jpg"],
        "altText": "Photos from summer vacation showing beach and mountains",
        "caption": "Had an amazing time exploring new places!"
      },
      "status": "published",
      "visibility": "public",
      "tags": ["vacation", "photography"]
    },
    {
      "title": "Project Files Download",
      "type": "file",
      "content": {
        "files": ["project.zip", "readme.txt"],
        "description": "Download the complete project files. Extract and follow the README instructions."
      },
      "status": "published",
      "visibility": "public",
      "tags": ["download", "project"]
    },
    {
      "title": "Podcast Episode #1",
      "type": "audio",
      "content": {
        "audioFile": "episode-1.mp3",
        "captionFile": "episode-1-transcript.vtt",
        "description": "In this first episode, we discuss the basics of web development."
      },
      "status": "published",
      "visibility": "public",
      "tags": ["podcast", "web-development"]
    },
    {
      "title": "Tutorial: How to code",
      "type": "video",
      "content": {
        "sourceType": "upload",
        "videoFile": "tutorial.mp4",
        "posterImage": "thumbnail.jpg",
        "captionFiles": ["subtitles-en.vtt", "subtitles-es.vtt"],
        "description": "A comprehensive tutorial covering the basics of coding."
      },
      "status": "published",
      "visibility": "public",
      "tags": ["tutorial", "coding", "education"]
    },
    {
      "title": "External Video Share",
      "type": "video",
      "content": {
        "sourceType": "url",
        "videoUrl": "https://youtube.com/watch?v=example",
        "description": "Great video explaining modern JavaScript concepts."
      },
      "status": "published",
      "visibility": "public",
      "tags": ["javascript", "education"]
    }
  ],
  "definitions": {
    "fileUpload": {
      "description": "File uploads should be handled as multipart/form-data in the API",
      "note": "All file fields marked with format: 'binary' should be processed as file uploads"
    },
    "markdownFields": {
      "description": "Fields that support Markdown formatting",
      "fields": [
        "content.body (text posts)",
        "content.quote (quote posts)",
        "content.source (quote posts)",
        "content.description (link, file, audio, video posts)",
        "content.caption (photo posts)"
      ]
    }
  }
}
